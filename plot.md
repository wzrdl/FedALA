为了详尽、严密地论证你的实验假设，并将这套复杂的机制解释清楚，你需要绘制 **7 张核心图表**。这 7 张图构成了一个完整的逻辑证据链：**现象展示  冲突定位  归因剥离  底层微观解释**。

以下是为你整理的详细绘制指令，你可以直接将这些要求转化为 `matplotlib` 或 `seaborn` 的绘图代码逻辑。

---

### 图 1：宏观表现 (Macro Forgetting Trajectory)

**目的**：展示 Personalization 对全局灾难性遗忘的总效应，确立基线现象。

* **图表类型**：折线图 (Line Plot)
* **X 轴**：全局通信轮次 (Global Communication Rounds)，例如 0 到 100。
* **Y 轴**：旧任务的全局平均准确率 (Average Global Accuracy on Old Tasks)。
* **包含曲线**：
* 组别 A (Full-FedALA) —— 实线，红色
* 组别 B (No-Pers) —— 实线，蓝色


* **视觉辅助**：
* 在每个任务切换的轮次（如 Round 20, 40, 60...）添加**垂直虚线 (Vertical Dashed Lines)**，并标注 "Task 2", "Task 3" 等。


* **核心结论**：直观展示引入 Personalization 后（A 组），在任务切换点是否出现了更陡峭的性能断崖。

### 图 2：聚合冲击微观放大图 (Aggregation Shock Dynamics)

**目的**：将视角聚焦在任务切换前后的几轮，直接量化聚合带来的破坏力。

* **图表类型**：局部放大折线图 / 柱状图 (Zoomed-in Line Plot or Bar Chart)
* **X 轴**：任务切换后的相对轮次 (Rounds after task switch, e.g., )。
* **Y 轴**：聚合冲击量  (即 )。
* **包含曲线**：组别 A 与 组别 B 的对比。
* **视觉辅助**：
* 在 Y=0 处画一条黑色水平基准线。
* 如果  为负，说明聚合导致了掉点（负尖峰）。


* **核心结论**：证明 A 组（有个性化）在切换任务的初期，会产生巨大的负向聚合冲击，这是遗忘发生的直接动作。

### 图 3：更新范数演化 (Subspace Update Norms)

**目的**：定位冲突源，展示个性化如何“充气”了特定子空间的更新幅度。

* **图表类型**：双子图折线图 (Two Subplots: top and bottom)
* **X 轴**：全局轮次 (包含任务切换线)。
* **Y 轴**：
* 子图 1: 平均 P 子空间更新范数 
* 子图 2: 平均 S 子空间更新范数 


* **包含曲线**：只画组别 A 和 B。
* **核心结论**：证明 A 组在任务切换时， 会出现巨大的尖峰（且显著高于 B 组），而  变化可能不大。这说明个性化主要在 P 空间引发了剧烈更新。

### 图 4：冲突源因果散点图 (The Causal Proof Scatter)

**目的**：在统计学上实锤“P 空间的剧烈更新”与“全局聚合掉点”存在强相关/因果关系。

* **图表类型**：散点图 + 线性回归拟合线 (Scatter Plot with Regression Line)
* **X 轴**：某轮的 P 子空间更新范数 。
* **Y 轴**：该轮的聚合冲击 。
* **数据点**：提取 A、B、C、D 四组在所有“任务切换窗口（切换后前 5 轮）”的数据点。不同组用不同颜色/形状标记。
* **核心结论**：你应该能看到一条明显的负相关拟合线——X 轴的值越大（P 空间更新越剧烈），Y 轴的值越小（聚合负冲击越大）。C 组（Freeze-P）的点应该集中在左上角（范数小，冲击弱）。

### 图 5：同进度能力对齐图 (Progress-Matched Anti-Confounder)

**目的**：这是防御审稿人攻击的最核心图表，排除“冻结参数导致学习慢，所以没遗忘”的混淆变量。

* **图表类型**：参数化轨迹折线图 / 散点图 (Trajectory Plot independent of Time)
* **X 轴**：当前新任务的准确率 (Accuracy on Current New Task) —— 代表“学习进度”。
* **Y 轴**：旧任务的平均准确率 (Accuracy on Old Tasks) —— 代表“记忆保留”。
* **包含曲线**：
* 组别 A (Full-FedALA)
* 组别 C (Freeze-P)
* 组别 D (Freeze-S)


* **核心结论**：比较在同一个 X 值（例如新任务都学到了 80% 准确率时），哪条曲线的 Y 值更高。如果 C 组始终在 A 组和 D 组上方，则完美证明：**保留记忆是因为切断了 P 空间的恶性更新，而不是因为模型学不动了**。

### 图 6：理论风险指标演化 (Landscape Sharpness & Drift)

**目的**：用优化理论解释为什么更新会变大、聚合会崩溃。

* **图表类型**：折线图 (双 Y 轴结构 - Dual Y-axis)
* **X 轴**：全局轮次。
* **Y 轴 (左)**：Hessian 最大特征值  （代表地貌陡峭度/风险）。
* **Y 轴 (右)**：最优解漂移距离 。
* **包含曲线**：组别 A 与 组别 B。
* **核心结论**：展示在开启个性化时，系统是否被推向了更高曲率（高 ）的区域，从而在面对新任务梯度时极易发生剧烈震荡。

### 图 7：微观探针诊断柱状图 (Microscopic Probe P1 Results)

**目的**：利用 P1 探针（影子测试），直接提供 Personalization 改变本地梯度几何特性的铁证。

* **图表类型**：分组柱状图 (Grouped Bar Chart)
* **X 轴**：对比指标（如：更新余弦相似度 Cos-Sim、旧任务 Loss 增加量、 范数）。
* **Y 轴**：指标的具体数值。
* **包含分组**：
* -start (未个性化起点，跑  步 SGD)
* -start (个性化起点，跑  步 SGD)


* **核心结论**：证明在同一个客户端、同批次数据下，仅仅因为起点的不同（引入了历史记忆），跑出来的更新在客户端之间更不一致（Cos-Sim 更低），且对旧任务造成的破坏（跑完  步后的旧任务 Loss）更大。
